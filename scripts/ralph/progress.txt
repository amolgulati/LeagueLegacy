# Fantasy League History Tracker - Ralph Progress Log
Started: 2025-01-07

## Codebase Patterns
- Backend: FastAPI with uvicorn at http://localhost:8000
- Frontend: React + Vite + TypeScript with Tailwind CSS at http://localhost:5173
- CORS configured to allow frontend dev server

## Key Files
- backend/app/main.py - FastAPI application entry point
- backend/app/api/routes.py - API route definitions
- frontend/src/App.tsx - Main React component
- frontend/src/index.css - Tailwind CSS imports

---

## 2025-01-07 - FLH-001
- What was implemented: Project structure initialization with FastAPI backend and React/Vite frontend
- Files changed:
  - Created backend/ folder with FastAPI app skeleton (main.py, routes.py, requirements.txt)
  - Created frontend/ folder with React/Vite/TypeScript/Tailwind CSS setup
  - Added README.md with project description and setup instructions
  - Added .gitignore files for both backend and frontend
- **Learnings:**
  - Tailwind CSS v3 needs explicit content paths in tailwind.config.js
  - CORS middleware is essential for frontend-backend communication during development
  - Both apps verified to start without errors (backend on 8000, frontend on 5173)

## 2025-01-07 - FLH-002
- What was implemented: SQLite database schema with SQLAlchemy models
- Files changed:
  - Created backend/app/db/__init__.py - Database module exports
  - Created backend/app/db/database.py - Engine, session factory, and init_db()
  - Created backend/app/db/models.py - All 6 models (Owner, League, Season, Team, Matchup, Trade)
  - Created backend/tests/__init__.py - Tests module
  - Created backend/tests/conftest.py - Pytest fixtures for in-memory SQLite testing
  - Created backend/tests/test_models.py - 14 comprehensive model tests
  - Updated backend/app/main.py - Added lifespan handler to init_db on startup
  - Updated backend/requirements.txt - Added pytest, pytest-asyncio
- **Learnings:**
  - Platform enum (YAHOO, SLEEPER) in SQLAlchemy uses SQLEnum for database storage
  - Owner model has unique yahoo_user_id and sleeper_user_id for cross-platform mapping
  - Trade-Team is a many-to-many relationship using association table
  - FastAPI lifespan context manager is preferred over on_event decorators
  - All 14 tests pass, including cross-platform owner aggregation test

## 2025-01-07 - FLH-003
- What was implemented: Sleeper API integration for fetching and storing fantasy football data
- Files changed:
  - Created backend/app/services/__init__.py - Services module exports
  - Created backend/app/services/sleeper_client.py - HTTP client for Sleeper API
  - Created backend/app/services/sleeper_service.py - Service for importing Sleeper data to DB
  - Created backend/app/api/sleeper.py - FastAPI routes for Sleeper endpoints
  - Updated backend/app/main.py - Include sleeper_router
  - Updated backend/tests/conftest.py - Added test_client fixture
  - Created backend/tests/test_sleeper.py - 24 comprehensive tests
- **Learnings:**
  - Sleeper API is public, no authentication required
  - Points stored as integers (fpts) with decimal part separate (fpts_decimal)
  - Matchups share same matchup_id for teams playing each other
  - Transactions include trades, waivers, and free agent pickups - filter by type
  - Python 3.9 requires `Optional[str]` instead of `str | None` for type hints
  - Use `app.services.sleeper_client.SleeperClient` path when patching in tests
  - All 38 tests pass (14 models + 24 sleeper)

## 2025-01-07 - FLH-004
- What was implemented: Yahoo Fantasy API integration with OAuth2 authentication
- Files changed:
  - Created backend/app/services/yahoo_client.py - HTTP client with OAuth2 support
  - Created backend/app/services/yahoo_service.py - Service for importing Yahoo data to DB
  - Created backend/app/api/yahoo.py - FastAPI routes for Yahoo OAuth and data endpoints
  - Updated backend/app/services/__init__.py - Added Yahoo exports
  - Updated backend/app/main.py - Include yahoo_router
  - Created backend/tests/test_yahoo.py - 28 comprehensive tests
- **Learnings:**
  - Yahoo Fantasy API requires OAuth2 authentication (unlike Sleeper which is public)
  - Yahoo API returns deeply nested JSON structures that need careful parsing
  - Token refresh is automatic when access token expires (with 5-minute buffer)
  - League keys use format "gameKey.l.leagueId" (e.g., "449.l.123456")
  - Yahoo stores standings with separate outcome_totals object for W/L/T
  - Matchups come from scoreboard endpoint, not matchups endpoint
  - Trades are a type of transaction, filtered from transactions endpoint
  - Use path parameters with :path suffix for league keys containing dots
  - In-memory token store works for development, needs proper session management for production
  - All 66 tests pass (14 models + 24 sleeper + 28 yahoo)
